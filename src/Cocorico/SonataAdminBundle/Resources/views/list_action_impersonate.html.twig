{% if admin.isGranted('EDIT', object) and admin.hasRoute('edit') %}
    {% set url =  path('cocorico_admin__trusted', {'id': object.id}) %}
    {% set user = object.impersonating %}

    <a target="_blank"
       class="btn btn-sm btn-default edit_link"
       href="{{ url(sonata_user.impersonating.route, sonata_user.impersonating.parameters | merge({'_become_who_you_are': user.username})) }}"
       title="{{ 'switch_user'|trans({}, 'SonataUserBundle') }}">
        <img src="{{ asset('bundles/sonataadmin/famfamfam/group_go.png') }}" width="12"
             alt="{{ 'switch_user'|trans({}, 'SonataUserBundle') }}" style="padding-bottom: 2px;"/>
        Impersonate
    </a>
{% endif %}